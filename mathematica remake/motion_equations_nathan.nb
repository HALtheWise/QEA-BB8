(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     59006,       1993]
NotebookOptionsPosition[     54530,       1832]
NotebookOutlinePosition[     54924,       1849]
CellTagsIndexPosition[     54881,       1846]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["Setup coordinate frames", "Section"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rvec", "=", 
   RowBox[{"r", " ", 
    RowBox[{"rhat", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xhat", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]hat", "[", "t", "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"rhat", "[", "t", "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yhat", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"\[Theta]hat", "[", "t", "]"}]}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"rhat", "[", "t", "]"}], 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xvec", "=", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], " ", "xhat"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"hvec", "=", 
  RowBox[{"xvec", "+", "rvec"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", " ", 
   RowBox[{"rhat", "[", "t", "]"}]}], "+", 
  RowBox[{
   RowBox[{"x", "[", "t", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"rhat", "[", "t", "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
      RowBox[{"\[Theta]hat", "[", "t", "]"}]}]}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rhat", "'"}], "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], " ", 
    RowBox[{"\[Theta]hat", "[", "t", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]hat", "'"}], "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], " ", 
    RowBox[{"rhat", "[", "t", "]"}]}]}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FullSimplify", "@", 
  RowBox[{"D", "[", 
   RowBox[{"rvec", ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "@", 
  RowBox[{"D", "[", 
   RowBox[{"hvec", ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{"r", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"rhat", "[", "t", "]"}]}], " ", 
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["\[Theta]", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
    RowBox[{
     RowBox[{"\[Theta]hat", "[", "t", "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rhat", "[", "t", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "r"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["\[Theta]", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["x", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"\[Theta]hat", "[", "t", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["x", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"r", " ", 
      RowBox[{
       SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$Assumptions", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"rhat", "[", "t_", "]"}], " ", 
     RowBox[{"\[Theta]hat", "[", "t_", "]"}]}], "==", "0"}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"rhat", "[", "t_", "]"}], " ", 
    RowBox[{"\[Theta]hat", "[", "t_", "]"}]}], "\[Equal]", "0"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"rhat", "[", "t", "]"}], " ", 
   RowBox[{"\[Theta]hat", "[", "t", "]"}]}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup forces", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fg2vec", "=", 
   RowBox[{
    RowBox[{"-", "m2"}], " ", "g", " ", "yhat"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fn2vec", "=", 
    RowBox[{
     RowBox[{"fn2", "[", "t", "]"}], " ", 
     RowBox[{"rhat", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Motor", " ", "force"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2vec", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"motor", "[", "t", "]"}]}], " ", 
    RowBox[{"\[Theta]hat", "[", "t", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f1vec", "=", 
   RowBox[{
    RowBox[{"f1", "[", "t", "]"}], " ", 
    RowBox[{"(", "xhat", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fg1vec", "=", 
   RowBox[{
    RowBox[{"-", "m1"}], " ", "g", " ", "yhat"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fn1vec", "=", 
   RowBox[{
    RowBox[{"fn1", "[", "t", "]"}], " ", "yhat"}]}], ";"}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Newton\[CloseCurlyQuote]s Laws as vector equations", "Section"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"headeqn", "=", 
   RowBox[{"FullSimplify", "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"fn2vec", "+", "f2vec", "+", "fg2vec"}], "\[Equal]", 
      RowBox[{"m2", " ", 
       RowBox[{"D", "[", 
        RowBox[{"hvec", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headeqn", "//", "TraditionalForm"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bodyeqn", "=", 
   RowBox[{"FullSimplify", "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "f1vec", "+", "fn1vec", "+", "fg1vec", "-", "fn2vec", "-", "f2vec"}], 
      "\[Equal]", 
      RowBox[{"m1", " ", 
       RowBox[{"D", "[", 
        RowBox[{"xvec", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bodyeqn", "//", "TraditionalForm"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bodymomenteqn", "=", 
   RowBox[{"FullSimplify", "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "r"}], " ", 
        RowBox[{"f1", "[", "t", "]"}]}], "+", 
       RowBox[{"r", " ", 
        RowBox[{"motor", "[", "t", "]"}]}]}], "\[Equal]", 
      RowBox[{"i", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "''"}], "[", "t", "]"}], "/", "r"}]}]}], " ", ")"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"bodymomenteqn", "//", "TraditionalForm"}]}], "Input"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"rhat", "(", "t", ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"fn2", "(", "t", ")"}], "-", 
       RowBox[{"g", " ", "m2", " ", 
        RowBox[{"cos", "(", 
         RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"\[Theta]hat", "(", "t", ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g", " ", "m2", " ", 
        RowBox[{"sin", "(", 
         RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}], "-", 
       RowBox[{"motor", "(", "t", ")"}]}], ")"}]}]}], "\[LongEqual]", 
   RowBox[{"m2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"rhat", "(", "t", ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"sin", "(", 
           RowBox[{"\[Theta]", "(", "t", ")"}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["x", "\[Prime]\[Prime]",
            MultilineFunction->None], "(", "t", ")"}]}], "-", 
         RowBox[{"r", " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["\[Theta]", "\[Prime]",
             MultilineFunction->None], "(", "t", ")"}], "2"]}]}], ")"}]}], 
      "+", 
      RowBox[{
       RowBox[{"\[Theta]hat", "(", "t", ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", " ", 
          RowBox[{
           SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
            MultilineFunction->None], "(", "t", ")"}]}], "+", 
         RowBox[{
          RowBox[{"cos", "(", 
           RowBox[{"\[Theta]", "(", "t", ")"}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["x", "\[Prime]\[Prime]",
            MultilineFunction->None], "(", "t", ")"}]}]}], ")"}]}]}], 
     ")"}]}]}], TraditionalForm]], "Output"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"rhat", "(", "t", ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"f1", "(", "t", ")"}], " ", 
        RowBox[{"sin", "(", 
         RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"fn1", "(", "t", ")"}], " ", 
        RowBox[{"cos", "(", 
         RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}], "-", 
       RowBox[{"fn2", "(", "t", ")"}], "-", 
       RowBox[{"g", " ", "m1", " ", 
        RowBox[{"cos", "(", 
         RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"\[Theta]hat", "(", "t", ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"f1", "(", "t", ")"}], " ", 
        RowBox[{"cos", "(", 
         RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"sin", "(", 
         RowBox[{"\[Theta]", "(", "t", ")"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "m1"}], "-", 
          RowBox[{"fn1", "(", "t", ")"}]}], ")"}]}], "+", 
       RowBox[{"motor", "(", "t", ")"}]}], ")"}]}]}], "\[LongEqual]", 
   RowBox[{"m1", " ", 
    RowBox[{
     SuperscriptBox["x", "\[Prime]\[Prime]",
      MultilineFunction->None], "(", "t", ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"rhat", "(", "t", ")"}], " ", 
       RowBox[{"sin", "(", 
        RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"\[Theta]hat", "(", "t", ")"}], " ", 
       RowBox[{"cos", "(", 
        RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}]}], ")"}]}]}], 
  TraditionalForm]], "Output"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"r", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"motor", "(", "t", ")"}], "-", 
      RowBox[{"f1", "(", "t", ")"}]}], ")"}]}], "\[LongEqual]", 
   FractionBox[
    RowBox[{"i", " ", 
     RowBox[{
      SuperscriptBox["x", "\[Prime]\[Prime]",
       MultilineFunction->None], "(", "t", ")"}]}], "r"]}], 
  TraditionalForm]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Extract the components of those equations into separate equations\
\>", "Section"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"eq1", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"#", " ", 
         RowBox[{"rhat", "[", "t", "]"}]}], "&"}], "/@", "headeqn"}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"rhat", "[", "t", "]"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"\[Theta]hat", "[", "t", "]"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}]}], "}"}]}], ")"}], "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"eq2", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"#", " ", 
         RowBox[{"\[Theta]hat", "[", "t", "]"}]}], "&"}], "/@", "headeqn"}], 
      ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"rhat", "[", "t", "]"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"\[Theta]hat", "[", "t", "]"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}]}], "}"}]}], ")"}], "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", "g"}], " ", "m2", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
   RowBox[{"fn2", "[", "t", "]"}]}], "\[Equal]", 
  RowBox[{"m2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "r"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["\[Theta]", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["x", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"motor", "[", "t", "]"}]}], "+", 
   RowBox[{"g", " ", "m2", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], "\[Equal]", 
  RowBox[{"m2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["x", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"r", " ", 
      RowBox[{
       SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"eq3", "=", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"#", " ", 
         RowBox[{"rhat", "[", "t", "]"}]}], "&"}], "/@", "bodyeqn"}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"rhat", "[", "t", "]"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"\[Theta]hat", "[", "t", "]"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}]}], "}"}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"eq4", "=", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"#", " ", 
         RowBox[{"\[Theta]hat", "[", "t", "]"}]}], "&"}], "/@", "bodyeqn"}], 
      ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"rhat", "[", "t", "]"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"\[Theta]hat", "[", "t", "]"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}]}], "}"}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "g"}], " ", "m1"}], "+", 
      RowBox[{"fn1", "[", "t", "]"}]}], ")"}]}], "-", 
   RowBox[{"fn2", "[", "t", "]"}], "+", 
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"f1", "[", "t", "]"}], "-", 
      RowBox[{"m1", " ", 
       RowBox[{
        SuperscriptBox["x", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], "\[Equal]",
   "0"}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
    RowBox[{"f1", "[", "t", "]"}]}], "+", 
   RowBox[{"motor", "[", "t", "]"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", " ", "m1"}], "-", 
      RowBox[{"fn1", "[", "t", "]"}]}], ")"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], "\[Equal]", 
  RowBox[{"m1", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["x", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq5", "=", "bodymomenteqn"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"f1", "[", "t", "]"}]}], "+", 
     RowBox[{"motor", "[", "t", "]"}]}], ")"}]}], "\[Equal]", 
  FractionBox[
   RowBox[{"i", " ", 
    RowBox[{
     SuperscriptBox["x", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], "r"]}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Eliminate the constraint forces", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqs", "=", 
  RowBox[{"FullSimplify", "@", 
   RowBox[{"Eliminate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eq1", ",", "eq2", ",", "eq3", ",", "eq4", ",", "eq5"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"fn1", "[", "t", "]"}], ",", 
       RowBox[{"fn2", "[", "t", "]"}], ",", 
       RowBox[{"f1", "[", "t", "]"}]}], "}"}]}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"i", " ", 
    RowBox[{
     SuperscriptBox["x", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], "\[Equal]", 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
       RowBox[{"motor", "[", "t", "]"}]}], "+", 
      RowBox[{"m2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "g"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"r", " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["\[Theta]", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}]}], 
      "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m1", "+", 
         RowBox[{"m2", " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], "2"]}]}], ")"}], " ", 
       
       RowBox[{
        SuperscriptBox["x", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], "&&", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"motor", "[", "t", "]"}], "-", 
     RowBox[{"g", " ", "m2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
     RowBox[{"m2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["x", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"m2", " ", "r", " ", 
      RowBox[{
       SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], "r"], "\[Equal]", 
   "0"}]}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solve for x\[CloseCurlyQuote]\[CloseCurlyQuote] and \[Theta]\
\[CloseCurlyQuote]\[CloseCurlyQuote]", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"textReplace", "=", 
  RowBox[{"<|", 
   RowBox[{
    RowBox[{"m1", "\[Rule]", 
     SubscriptBox["m", "1"]}], ",", 
    RowBox[{"m2", "\[Rule]", 
     SubscriptBox["m", "2"]}], ",", 
    RowBox[{"i", "\[Rule]", "\"\<I\>\""}], ",", 
    RowBox[{"Kpx", "\[Rule]", 
     SubscriptBox["P", "x"]}], ",", 
    RowBox[{"Kdx", "\[Rule]", "\"\<\!\(\*SubscriptBox[\(D\), \(x\)]\)\>\""}], 
    ",", 
    RowBox[{"Kp\[Theta]", "\[Rule]", 
     SubscriptBox["P", "\[Theta]"]}], ",", 
    RowBox[{
    "Kd\[Theta]", "\[Rule]", 
     "\"\<\!\(\*SubscriptBox[\(D\), \(\[Theta]\)]\)\>\""}]}], 
   "|>"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"m1", "\[Rule]", 
    SubscriptBox["m", "1"]}], ",", 
   RowBox[{"m2", "\[Rule]", 
    SubscriptBox["m", "2"]}], ",", 
   RowBox[{"i", "\[Rule]", "\<\"I\"\>"}], ",", 
   RowBox[{"Kpx", "\[Rule]", 
    SubscriptBox["P", "x"]}], ",", 
   RowBox[{
   "Kdx", "\[Rule]", "\<\"\\!\\(\\*SubscriptBox[\\(D\\), \\(x\\)]\\)\"\>"}], 
   ",", 
   RowBox[{"Kp\[Theta]", "\[Rule]", 
    SubscriptBox["P", "\[Theta]"]}], ",", 
   RowBox[{
   "Kd\[Theta]", 
    "\[Rule]", "\<\"\\!\\(\\*SubscriptBox[\\(D\\), \
\\(\[Theta]\\)]\\)\"\>"}]}], "\[RightAssociation]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "''"}], "[", "t", "]"}], "\[Rule]", "xdd"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Theta]", "''"}], "[", "t", "]"}], "\[Rule]", 
      "\[Theta]dd"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{
    RowBox[{"FullSimplify", "@", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"eqs", "/.", "rules"}], ",", 
       RowBox[{"{", 
        RowBox[{"xdd", ",", "\[Theta]dd"}], "}"}]}], "]"}]}], "/.", 
    RowBox[{"(", 
     RowBox[{"Reverse", "/@", "rules"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Apply", "[", 
      RowBox[{"Equal", ",", "#"}], "]"}], "&"}], "/@", 
    RowBox[{"sol", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Column", "[", 
   RowBox[{"sol", ",", 
    RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "//", 
  "TraditionalForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<eqn.svg\>\"", ",", "%"}], "]"}], "*)"}]}]}], "Input"],

Cell[BoxData[
 FormBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "\[Prime]\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], "\[LongEqual]", 
       FractionBox[
        RowBox[{
         SuperscriptBox["r", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m2", " ", 
            RowBox[{"sin", "(", 
             RowBox[{"\[Theta]", "(", "t", ")"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"r", " ", 
               SuperscriptBox[
                RowBox[{
                 SuperscriptBox["\[Theta]", "\[Prime]",
                  MultilineFunction->None], "(", "t", ")"}], "2"]}], "-", 
              RowBox[{"g", " ", 
               RowBox[{"cos", "(", 
                RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}]}], ")"}]}], "+", 
           
           RowBox[{
            RowBox[{"motor", "(", "t", ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"cos", "(", 
               RowBox[{"\[Theta]", "(", "t", ")"}], ")"}], "+", "1"}], 
             ")"}]}]}], ")"}]}], 
        RowBox[{"i", "+", 
         RowBox[{"m1", " ", 
          SuperscriptBox["r", "2"]}], "+", 
         RowBox[{"m2", " ", 
          SuperscriptBox["r", "2"], " ", 
          RowBox[{
           SuperscriptBox["sin", "2"], "(", 
           RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}]}]]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], "\[LongEqual]", 
       FractionBox[
        RowBox[{
         RowBox[{"m2", " ", 
          RowBox[{"sin", "(", 
           RowBox[{"\[Theta]", "(", "t", ")"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", 
             RowBox[{"(", 
              RowBox[{"i", "+", 
               RowBox[{
                SuperscriptBox["r", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}], "-", 
            RowBox[{"m2", " ", 
             SuperscriptBox["r", "3"], " ", 
             SuperscriptBox[
              RowBox[{
               SuperscriptBox["\[Theta]", "\[Prime]",
                MultilineFunction->None], "(", "t", ")"}], "2"], " ", 
             RowBox[{"cos", "(", 
              RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"motor", "(", "t", ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"i", "+", 
            RowBox[{
             SuperscriptBox["r", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"m1", "+", "m2"}], ")"}]}], "+", 
            RowBox[{"m2", " ", 
             SuperscriptBox["r", "2"], " ", 
             RowBox[{"cos", "(", 
              RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}]}], ")"}]}]}], 
        RowBox[{"m2", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{"i", "+", 
           RowBox[{"m1", " ", 
            SuperscriptBox["r", "2"]}], "+", 
           RowBox[{"m2", " ", 
            SuperscriptBox["r", "2"], " ", 
            RowBox[{
             SuperscriptBox["sin", "2"], "(", 
             RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}]}], ")"}]}]]}]}
    },
    DefaultBaseStyle->"Column",
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"], TraditionalForm]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sol", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "/.", "textReplace"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["x", "\[Prime]\[Prime]",
    MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
  FractionBox[
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
       RowBox[{"motor", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       SubscriptBox["m", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "g"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"r", " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["\[Theta]", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}]}]}], 
     ")"}]}], 
   RowBox[{"\<\"I\"\>", "+", 
    RowBox[{
     SuperscriptBox["r", "2"], " ", 
     SubscriptBox["m", "1"]}], "+", 
    RowBox[{
     SuperscriptBox["r", "2"], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], "2"], " ", 
     SubscriptBox["m", "2"]}]}]]}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linearize equations", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"motorPDRule", "=", 
  RowBox[{"<|", 
   RowBox[{
    RowBox[{"motor", "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"Kpx", " ", 
      RowBox[{"x", "[", "t", "]"}]}], "+", 
     RowBox[{"Kp\[Theta]", " ", 
      RowBox[{"\[Theta]", "[", "t", "]"}]}], "+", 
     RowBox[{"Kdx", " ", 
      RowBox[{
       RowBox[{"x", "'"}], "[", "t", "]"}]}], " ", "+", 
     RowBox[{"Kd\[Theta]", " ", 
      RowBox[{
       RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}]}]}], "|>"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"motor", "[", "t", "]"}], "\[Rule]", 
   RowBox[{
    RowBox[{"Kpx", " ", 
     RowBox[{"x", "[", "t", "]"}]}], "+", 
    RowBox[{"Kp\[Theta]", " ", 
     RowBox[{"\[Theta]", "[", "t", "]"}]}], "+", 
    RowBox[{"Kdx", " ", 
     RowBox[{
      SuperscriptBox["x", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], "+", 
    RowBox[{"Kd\[Theta]", " ", 
     RowBox[{
      SuperscriptBox["\[Theta]", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}]}]}], 
  "\[RightAssociation]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"zeroMotorRule", "=", 
  RowBox[{"<|", 
   RowBox[{
    RowBox[{"Kpx", "\[Rule]", "0"}], " ", ",", 
    RowBox[{"Kp\[Theta]", " ", "\[Rule]", "0"}], ",", 
    RowBox[{"Kdx", " ", "\[Rule]", "0"}], ",", " ", 
    RowBox[{"Kd\[Theta]", "\[Rule]", "0"}]}], "|>"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"Kpx", "\[Rule]", "0"}], ",", 
   RowBox[{"Kp\[Theta]", "\[Rule]", "0"}], ",", 
   RowBox[{"Kdx", "\[Rule]", "0"}], ",", 
   RowBox[{"Kd\[Theta]", "\[Rule]", "0"}]}], 
  "\[RightAssociation]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"linearizedEquations", "=", 
  RowBox[{"MapAt", "[", 
   RowBox[{"Simplify", ",", 
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{"sol", "/.", "motorPDRule"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Theta]", "[", "t", "]"}], ",", "0", ",", "1"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], ",", "0", ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "[", "t", "]"}], ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "'"}], "[", "t", "]"}], ",", "0", ",", "1"}], "}"}]}], 
      "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", "Kpx", " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"x", "[", "t", "]"}]}], 
      RowBox[{"i", "+", 
       RowBox[{"m1", " ", 
        SuperscriptBox["r", "2"]}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "Kp\[Theta]"}], "-", 
         RowBox[{"g", " ", "m2"}]}], ")"}], " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], 
      RowBox[{"i", "+", 
       RowBox[{"m1", " ", 
        SuperscriptBox["r", "2"]}]}]], "+", 
     FractionBox[
      RowBox[{"2", " ", "Kdx", " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{
        SuperscriptBox["x", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{"i", "+", 
       RowBox[{"m1", " ", 
        SuperscriptBox["r", "2"]}]}]], "+", 
     FractionBox[
      RowBox[{"2", " ", "Kd\[Theta]", " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{
        SuperscriptBox["\[Theta]", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{"i", "+", 
       RowBox[{"m1", " ", 
        SuperscriptBox["r", "2"]}]}]]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "Kpx"}], " ", 
       RowBox[{"(", 
        RowBox[{"i", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"m1", "+", 
            RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
          SuperscriptBox["r", "2"]}]}], ")"}], " ", 
       RowBox[{"x", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"i", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "Kp\[Theta]"}], "+", 
            RowBox[{"g", " ", "m2"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "m2", " ", 
             RowBox[{"(", 
              RowBox[{"m1", "+", "m2"}], ")"}]}], "-", 
            RowBox[{"Kp\[Theta]", " ", 
             RowBox[{"(", 
              RowBox[{"m1", "+", 
               RowBox[{"2", " ", "m2"}]}], ")"}]}]}], ")"}], " ", 
          SuperscriptBox["r", "2"]}]}], ")"}], " ", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"i", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"m1", "+", 
            RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
          SuperscriptBox["r", "2"]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Kdx", " ", 
          RowBox[{
           SuperscriptBox["x", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"Kd\[Theta]", " ", 
          RowBox[{
           SuperscriptBox["\[Theta]", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], 
     RowBox[{"m2", " ", "r", " ", 
      RowBox[{"(", 
       RowBox[{"i", "+", 
        RowBox[{"m1", " ", 
         SuperscriptBox["r", "2"]}]}], ")"}]}]]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"linearizedEquations", "/.", "textReplace"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["r", "2"], " ", 
       SubscriptBox["P", "x"], " ", 
       RowBox[{"x", "[", "t", "]"}]}], 
      RowBox[{"\<\"I\"\>", "+", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        SubscriptBox["m", "1"]}]}]], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "g"}], " ", 
          SubscriptBox["m", "2"]}], "+", 
         RowBox[{"2", " ", 
          SubscriptBox["P", "\[Theta]"]}]}], ")"}], " ", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], 
      RowBox[{"\<\"I\"\>", "+", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        SubscriptBox["m", "1"]}]}]], "+", 
     FractionBox[
      RowBox[{
      "2", " ", "\<\"\\!\\(\\*SubscriptBox[\\(D\\), \\(x\\)]\\)\"\>", " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{
        SuperscriptBox["x", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{"\<\"I\"\>", "+", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        SubscriptBox["m", "1"]}]}]], "+", 
     FractionBox[
      RowBox[{
      "2", " ", "\<\"\\!\\(\\*SubscriptBox[\\(D\\), \\(\[Theta]\\)]\\)\"\>", 
       " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{
        SuperscriptBox["\[Theta]", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{"\<\"I\"\>", "+", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        SubscriptBox["m", "1"]}]}]]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"\<\"I\"\>", "+", 
          RowBox[{
           SuperscriptBox["r", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["m", "1"], "+", 
             RowBox[{"2", " ", 
              SubscriptBox["m", "2"]}]}], ")"}]}]}], ")"}]}], " ", 
       SubscriptBox["P", "x"], " ", 
       RowBox[{"x", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\<\"I\"\>", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", 
             SubscriptBox["m", "2"]}], "-", 
            SubscriptBox["P", "\[Theta]"]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", 
             SubscriptBox["m", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["m", "1"], "+", 
               SubscriptBox["m", "2"]}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["m", "1"], "+", 
               RowBox[{"2", " ", 
                SubscriptBox["m", "2"]}]}], ")"}], " ", 
             SubscriptBox["P", "\[Theta]"]}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\<\"I\"\>", "+", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["m", "1"], "+", 
            RowBox[{"2", " ", 
             SubscriptBox["m", "2"]}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(D\\), \\(x\\)]\\)\"\>", " ", 
          RowBox[{
           SuperscriptBox["x", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(D\\), \\(\[Theta]\\)]\\)\"\>", 
          " ", 
          RowBox[{
           SuperscriptBox["\[Theta]", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], 
     RowBox[{"r", " ", 
      RowBox[{"(", 
       RowBox[{"\<\"I\"\>", "+", 
        RowBox[{
         SuperscriptBox["r", "2"], " ", 
         SubscriptBox["m", "1"]}]}], ")"}], " ", 
      SubscriptBox["m", "2"]}]]}]}], "}"}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Eigenvalues", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "linearizedEquations", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", "2", "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"changeLater", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "''"}], "[", "t", "]"}], "\[Rule]", 
      RowBox[{
       SuperscriptBox["\[Lambda]", "2"], "x"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "'"}], "[", "t", "]"}], "\[Rule]", 
      RowBox[{"\[Lambda]", " ", "x"}]}], ",", 
     RowBox[{
      RowBox[{"x", "[", "t", "]"}], "\[Rule]", "x"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Theta]", "''"}], "[", "t", "]"}], "\[Rule]", 
      RowBox[{
       SuperscriptBox["\[Lambda]", "2"], "\[Theta]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "\[Rule]", 
      RowBox[{"\[Lambda]", " ", "\[Theta]"}]}], ",", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", "\[Theta]"}]}], 
    "|>"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"coefMatrix", "=", 
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"CoefficientArrays", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"linearizedEquations", "/.", "changeLater"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "\[Theta]"}], "}"}]}], "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"coefMatrix", "//", "MatrixForm"}]}], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", "Kpx", " ", 
          SuperscriptBox["r", "2"]}], 
         RowBox[{"i", "+", 
          RowBox[{"m1", " ", 
           SuperscriptBox["r", "2"]}]}]]}], "-", 
       FractionBox[
        RowBox[{"2", " ", "Kdx", " ", 
         SuperscriptBox["r", "2"], " ", "\[Lambda]"}], 
        RowBox[{"i", "+", 
         RowBox[{"m1", " ", 
          SuperscriptBox["r", "2"]}]}]], "+", 
       SuperscriptBox["\[Lambda]", "2"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", "Kp\[Theta]", " ", 
          SuperscriptBox["r", "2"]}], 
         RowBox[{"i", "+", 
          RowBox[{"m1", " ", 
           SuperscriptBox["r", "2"]}]}]]}], "+", 
       FractionBox[
        RowBox[{"g", " ", "m2", " ", 
         SuperscriptBox["r", "2"]}], 
        RowBox[{"i", "+", 
         RowBox[{"m1", " ", 
          SuperscriptBox["r", "2"]}]}]], "-", 
       FractionBox[
        RowBox[{"2", " ", "Kd\[Theta]", " ", 
         SuperscriptBox["r", "2"], " ", "\[Lambda]"}], 
        RowBox[{"i", "+", 
         RowBox[{"m1", " ", 
          SuperscriptBox["r", "2"]}]}]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{"Kpx", " ", 
         RowBox[{"(", 
          RowBox[{"i", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m1", "+", 
              RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
            SuperscriptBox["r", "2"]}]}], ")"}]}], 
        RowBox[{"m2", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{"i", "+", 
           RowBox[{"m1", " ", 
            SuperscriptBox["r", "2"]}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"Kdx", " ", 
         RowBox[{"(", 
          RowBox[{"i", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m1", "+", 
              RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
            SuperscriptBox["r", "2"]}]}], ")"}], " ", "\[Lambda]"}], 
        RowBox[{"m2", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{"i", "+", 
           RowBox[{"m1", " ", 
            SuperscriptBox["r", "2"]}]}], ")"}]}]]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"i", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "Kp\[Theta]"}], "+", 
             RowBox[{"g", " ", "m2"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", "m2", " ", 
              RowBox[{"(", 
               RowBox[{"m1", "+", "m2"}], ")"}]}], "-", 
             RowBox[{"Kp\[Theta]", " ", 
              RowBox[{"(", 
               RowBox[{"m1", "+", 
                RowBox[{"2", " ", "m2"}]}], ")"}]}]}], ")"}], " ", 
           SuperscriptBox["r", "2"]}]}], 
         RowBox[{"m2", " ", "r", " ", 
          RowBox[{"(", 
           RowBox[{"i", "+", 
            RowBox[{"m1", " ", 
             SuperscriptBox["r", "2"]}]}], ")"}]}]]}], "+", 
       FractionBox[
        RowBox[{"Kd\[Theta]", " ", 
         RowBox[{"(", 
          RowBox[{"i", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m1", "+", 
              RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
            SuperscriptBox["r", "2"]}]}], ")"}], " ", "\[Lambda]"}], 
        RowBox[{"m2", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{"i", "+", 
           RowBox[{"m1", " ", 
            SuperscriptBox["r", "2"]}]}], ")"}]}]], "+", 
       SuperscriptBox["\[Lambda]", "2"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"poly", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Det", "[", "coefMatrix", "]"}], ",", "\[Lambda]", ",", 
    "Simplify"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"g", " ", "Kpx", " ", "r"}], 
   RowBox[{"i", "+", 
    RowBox[{"m1", " ", 
     SuperscriptBox["r", "2"]}]}]], "+", 
  FractionBox[
   RowBox[{"g", " ", "Kdx", " ", "r", " ", "\[Lambda]"}], 
   RowBox[{"i", "+", 
    RowBox[{"m1", " ", 
     SuperscriptBox["r", "2"]}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"i", " ", 
       RowBox[{"(", 
        RowBox[{"Kp\[Theta]", "-", 
         RowBox[{"g", " ", "m2"}]}], ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "Kp\[Theta]"}], " ", 
          RowBox[{"(", 
           RowBox[{"m1", "+", 
            RowBox[{"2", " ", "m2"}]}], ")"}]}], "+", 
         RowBox[{"m2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", 
             RowBox[{"(", 
              RowBox[{"m1", "+", "m2"}], ")"}]}], "+", 
            RowBox[{"2", " ", "Kpx", " ", "r"}]}], ")"}]}]}], ")"}]}]}], 
     ")"}], " ", 
    SuperscriptBox["\[Lambda]", "2"]}], 
   RowBox[{"m2", " ", "r", " ", 
    RowBox[{"(", 
     RowBox[{"i", "+", 
      RowBox[{"m1", " ", 
       SuperscriptBox["r", "2"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"i", " ", "Kd\[Theta]"}], "+", 
      RowBox[{"Kd\[Theta]", " ", "m1", " ", 
       SuperscriptBox["r", "2"]}], "+", 
      RowBox[{"2", " ", "Kd\[Theta]", " ", "m2", " ", 
       SuperscriptBox["r", "2"]}], "-", 
      RowBox[{"2", " ", "Kdx", " ", "m2", " ", 
       SuperscriptBox["r", "3"]}]}], ")"}], " ", 
    SuperscriptBox["\[Lambda]", "3"]}], 
   RowBox[{
    RowBox[{"i", " ", "m2", " ", "r"}], "+", 
    RowBox[{"m1", " ", "m2", " ", 
     SuperscriptBox["r", "3"]}]}]], "+", 
  SuperscriptBox["\[Lambda]", "4"]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"params", "=", 
  RowBox[{"<|", 
   RowBox[{
    RowBox[{"m1", "\[Rule]", "28.94"}], ",", 
    RowBox[{"m2", "\[Rule]", "1"}], ",", 
    RowBox[{"g", "\[Rule]", "9.8"}], ",", 
    RowBox[{"i", "\[Rule]", "2.7425"}], ",", 
    RowBox[{"r", "\[Rule]", ".788"}]}], "|>"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"m1", "\[Rule]", "28.94`"}], ",", 
   RowBox[{"m2", "\[Rule]", "1"}], ",", 
   RowBox[{"g", "\[Rule]", "9.8`"}], ",", 
   RowBox[{"i", "\[Rule]", "2.7425`"}], ",", 
   RowBox[{"r", "\[Rule]", "0.788`"}]}], "\[RightAssociation]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[{
  FormBox[
   RowBox[{"Routh", " ", "Hurwitz", " ", "stability", " ", "criterion"}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"Fourth", " ", "order"}], TraditionalForm], "\[IndentingNewLine]", 
 
  FormBox[
   RowBox[{
    RowBox[{"P", "(", "\[Lambda]", ")"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"a4", " ", 
       SuperscriptBox["\[Lambda]", "4"]}], "+", 
      RowBox[{"a3", " ", 
       SuperscriptBox["\[Lambda]", "3"]}], "+", 
      RowBox[{"a2", " ", 
       SuperscriptBox["\[Lambda]", "2"]}], "+", 
      RowBox[{"a1", " ", "\[Lambda]"}], "+", "a0"}], "=", "0"}]}], 
   TraditionalForm]}]],
 "\na3 a2 > a4 a1\na3 a2 a1 > a4 ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["a1", "2"], "+", 
    SuperscriptBox["a3", "2"]}], TraditionalForm]]],
 " a0"
}], "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"coeffs", "=", 
   RowBox[{"CoefficientList", "[", 
    RowBox[{"poly", ",", "\[Lambda]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aList", "=", 
   RowBox[{
    RowBox[{"Simplify", "[", "coeffs", "]"}], "/.", "params"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"aRules", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a0", ",", "a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], ",",
       "aList"}], "}"}]}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a0", "\[Rule]", 
    RowBox[{"0.3728355098782639`", " ", "Kpx"}]}], ",", 
   RowBox[{"a1", "\[Rule]", 
    RowBox[{"0.3728355098782639`", " ", "Kdx"}]}], ",", 
   RowBox[{"a2", "\[Rule]", 
    RowBox[{"0.0612687130940895`", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.620944`"}], " ", 
        RowBox[{"(", 
         RowBox[{"293.41200000000003`", "\[VeryThinSpace]", "+", 
          RowBox[{"1.576`", " ", "Kpx"}], "-", 
          RowBox[{"30.94`", " ", "Kp\[Theta]"}]}], ")"}]}], "+", 
       RowBox[{"2.7425`", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "9.8`"}], "+", "Kp\[Theta]"}], ")"}]}]}], ")"}]}]}], 
   ",", 
   RowBox[{"a3", "\[Rule]", 
    RowBox[{"0.061268713094089496`", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.9786077440000002`"}], " ", "Kdx"}], "+", 
       RowBox[{"21.95450736`", " ", "Kd\[Theta]"}]}], ")"}]}]}], ",", 
   RowBox[{"a4", "\[Rule]", "1"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pdRules", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Kpx", "\[Rule]", ".0884"}], ",", 
    RowBox[{"Kp\[Theta]", "\[Rule]", "9"}], ",", 
    RowBox[{"Kdx", "\[Rule]", ".648"}], ",", " ", 
    RowBox[{"Kd\[Theta]", "\[Rule]", ".442"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"stability", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"a3", " ", "a2"}], " ", ">", " ", 
       RowBox[{"a4", " ", "a1"}]}], "&&", " ", 
      RowBox[{
       RowBox[{"a3", " ", "a2", " ", "a1"}], ">", 
       RowBox[{
        RowBox[{"a4", " ", 
         SuperscriptBox["a1", "2"]}], " ", "+", " ", 
        RowBox[{
         SuperscriptBox["a3", "2"], "a0"}]}]}]}], "}"}], "/.", "aRules"}], "/.",
    "pdRules"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Kpx", "\[Rule]", "0.0884`"}], ",", 
   RowBox[{"Kp\[Theta]", "\[Rule]", "9"}], ",", 
   RowBox[{"Kdx", "\[Rule]", "0.648`"}], ",", 
   RowBox[{"Kd\[Theta]", "\[Rule]", "0.442`"}]}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", "False", "}"}]], "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Laplace", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$Assumptions", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"#", ">", "0"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"a1", ",", "a3", ",", "a4"}], "}"}]}], "/.", 
   "aRules"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"0.3728355098782639`", " ", "Kdx"}], ">", "0"}], ",", 
   RowBox[{
    RowBox[{"0.061268713094089496`", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.9786077440000002`"}], " ", "Kdx"}], "+", 
       RowBox[{"21.95450736`", " ", "Kd\[Theta]"}]}], ")"}]}], ">", "0"}], 
   ",", "True"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"a1", " ", "a2", " ", "a3"}], ">", 
    RowBox[{
     SuperscriptBox["a3", "2"], "+", 
     RowBox[{
      SuperscriptBox["a1", "2"], "a4"}]}]}], ")"}], "/.", "aRules"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.001399570519069264`", " ", "Kdx", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.9786077440000002`"}], " ", "Kdx"}], "+", 
     RowBox[{"21.95450736`", " ", "Kd\[Theta]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.620944`"}], " ", 
      RowBox[{"(", 
       RowBox[{"293.41200000000003`", "\[VeryThinSpace]", "+", 
        RowBox[{"1.576`", " ", "Kpx"}], "-", 
        RowBox[{"30.94`", " ", "Kp\[Theta]"}]}], ")"}]}], "+", 
     RowBox[{"2.7425`", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "9.8`"}], "+", "Kp\[Theta]"}], ")"}]}]}], ")"}]}], ">", 
  RowBox[{
   RowBox[{"0.13900631742618502`", " ", 
    SuperscriptBox["Kdx", "2"]}], "+", 
   RowBox[{"0.0037538552042058536`", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.9786077440000002`"}], " ", "Kdx"}], "+", 
       RowBox[{"21.95450736`", " ", "Kd\[Theta]"}]}], ")"}], 
     "2"]}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a1", " ", "a2", " ", "a3"}], ">", 
      RowBox[{
       SuperscriptBox["a3", "2"], "+", 
       RowBox[{
        SuperscriptBox["a1", "2"], "a4"}]}]}], ")"}], "/.", "aRules"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "Kpx", " ", ",", "Kp\[Theta]", " ", ",", "Kdx", " ", ",", "Kd\[Theta]"}], 
    " ", "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 TemplateBox[{
  "Solve","fulldim",
   "\"The solution set contains a full-dimensional component; use Reduce for \
complete solution information.\"",2,52,38,20756742300420509111,"Local"},
  "MessageTemplate"]], "Message", "MSG"],

Cell[BoxData[
 TemplateBox[{
  "Solve","ratnz",
   "\"Solve was unable to solve the system with inexact coefficients. The \
answer was obtained by solving a corresponding exact system and numericizing \
the result.\"",2,52,39,20756742300420509111,"Local"},
  "MessageTemplate"]], "Message", "MSG"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "}"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExportString", "[", 
  RowBox[{"\[UHat]", ",", "\"\<TeXFragment\>\""}], "]"}]], "Input"],

Cell[BoxData["\<\"\\\\[\\\\text{\\\\^ u}\\\\]\\n\\n\"\>"], "Output"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1916, 1041},
WindowMargins->{{2, Automatic}, {2, Automatic}},
TrackCellChangeTimes->False,
Magnification:>1.25 Inherited,
FrontEndVersion->"11.0 for Linux x86 (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 150, 4, 64, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[733, 28, 42, 0, 81, "Section"],
Cell[CellGroupData[{
Cell[800, 32, 1093, 36, 142, "Input"],
Cell[1896, 70, 483, 15, 40, "Output"]
}, Open  ]],
Cell[2394, 88, 514, 18, 67, "Input"],
Cell[CellGroupData[{
Cell[2933, 110, 335, 10, 67, "Input"],
Cell[3271, 122, 492, 15, 46, "Output"],
Cell[3766, 139, 1012, 31, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4815, 175, 210, 6, 40, "Input"],
Cell[5028, 183, 182, 6, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5247, 194, 155, 4, 40, "Input"],
Cell[5405, 200, 28, 0, 38, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5482, 206, 31, 0, 81, "Section"],
Cell[5516, 208, 1034, 34, 195, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6587, 247, 69, 0, 81, "Section"],
Cell[CellGroupData[{
Cell[6681, 251, 1570, 49, 231, "Input"],
Cell[8254, 302, 1796, 53, 67, "Output"],
Cell[10053, 357, 1700, 50, 59, "Output"],
Cell[11756, 409, 390, 13, 88, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12195, 428, 92, 2, 81, "Section"],
Cell[CellGroupData[{
Cell[12312, 434, 1317, 43, 67, "Input"],
Cell[13632, 479, 705, 22, 46, "Output"],
Cell[14340, 503, 662, 20, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15039, 528, 1349, 43, 67, "Input"],
Cell[16391, 573, 672, 22, 40, "Output"],
Cell[17066, 597, 657, 20, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17760, 622, 63, 1, 40, "Input"],
Cell[17826, 625, 366, 12, 69, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18241, 643, 50, 0, 81, "Section"],
Cell[CellGroupData[{
Cell[18316, 647, 413, 12, 40, "Input"],
Cell[18732, 661, 1993, 60, 69, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20774, 727, 117, 1, 81, "Section"],
Cell[CellGroupData[{
Cell[20916, 732, 623, 18, 40, "Input"],
Cell[21542, 752, 627, 18, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22206, 775, 1225, 40, 147, "Input"],
Cell[23434, 817, 3531, 96, 141, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27002, 918, 114, 3, 40, "Input"],
Cell[27119, 923, 1310, 41, 80, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28478, 970, 38, 0, 81, "Section"],
Cell[CellGroupData[{
Cell[28541, 974, 512, 15, 40, "Input"],
Cell[29056, 991, 588, 17, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29681, 1013, 296, 7, 40, "Input"],
Cell[29980, 1022, 273, 7, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30290, 1034, 858, 26, 44, "Input"],
Cell[31151, 1062, 3361, 102, 153, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34549, 1169, 78, 1, 40, "Input"],
Cell[34630, 1172, 4309, 128, 158, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[38988, 1306, 30, 0, 81, "Section"],
Cell[CellGroupData[{
Cell[39043, 1310, 81, 1, 44, "Input"],
Cell[39127, 1313, 50, 1, 40, "Output"]
}, Open  ]],
Cell[39192, 1317, 881, 27, 42, "Input"],
Cell[CellGroupData[{
Cell[40098, 1348, 472, 12, 70, "Input"],
Cell[40573, 1362, 4087, 121, 138, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44697, 1488, 181, 5, 44, "Input"],
Cell[44881, 1495, 1871, 59, 84, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46789, 1559, 304, 8, 40, "Input"],
Cell[47096, 1569, 309, 7, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47442, 1581, 858, 28, 200, "Subsection"],
Cell[CellGroupData[{
Cell[48325, 1613, 621, 19, 98, "Input"],
Cell[48949, 1634, 1047, 29, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50033, 1668, 790, 24, 72, "Input"],
Cell[50826, 1694, 251, 6, 40, "Output"],
Cell[51080, 1702, 54, 1, 40, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51195, 1710, 26, 0, 81, "Section"],
Cell[CellGroupData[{
Cell[51246, 1714, 228, 8, 40, "Input"],
Cell[51477, 1724, 401, 12, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51915, 1741, 244, 8, 46, "Input"],
Cell[52162, 1751, 1032, 30, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53231, 1786, 435, 14, 46, "Input"],
Cell[53669, 1802, 242, 5, 27, "Message"],
Cell[53914, 1809, 297, 6, 27, "Message"],
Cell[54214, 1817, 68, 2, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54319, 1824, 112, 2, 44, "Input"],
Cell[54434, 1828, 68, 0, 91, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

