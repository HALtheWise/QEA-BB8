Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["Setup coordinate frames", "Section"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"xhat", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"1", ",", " ", "0", ",", " ", "0"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"yhat", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", " ", "1", ",", " ", "0"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"zhat", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"0", ",", " ", "0", " ", ",", "1"}], "}"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0", ",", "0"}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "0"}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "1"}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Theta]zrot", "[", "t_", "]"}], " ", ":=", " ", 
  RowBox[{"RotationMatrix", "[", 
   RowBox[{
    RowBox[{"\[Theta]", "[", "t", "]"}], ",", " ", "zhat"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]yrot", "[", "t_", "]"}], " ", ":=", " ", 
   RowBox[{"RotationMatrix", "[", 
    RowBox[{
     RowBox[{"\[Phi]", "[", "t", "]"}], ",", " ", "yhat"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhat", "[", "t_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"\[Phi]yrot", "[", "t", "]"}], ".", 
   RowBox[{"\[Theta]zrot", "[", "t", "]"}], ".", 
   "yhat"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]hat", "[", "t_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"\[Phi]yrot", "[", "t", "]"}], ".", 
   RowBox[{"\[Theta]zrot", "[", "t", "]"}], ".", 
   "xhat"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]hat", "[", "t_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"\[Phi]yrot", "[", "t", "]"}], ".", 
    RowBox[{"\[Theta]zrot", "[", "t", "]"}], ".", "zhat"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rvec", "[", "t_", "]"}], " ", ":=", " ", 
  RowBox[{"r", " ", 
   RowBox[{"rhat", "[", "t", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"svec", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "[", "t", "]"}], " ", "xhat"}], "+", " ", 
    RowBox[{
     RowBox[{"z", "[", "t", "]"}], " ", "zhat"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hvec", "[", "t_", "]"}], ":=", 
  RowBox[{
   RowBox[{"svec", "[", "t", "]"}], "+", 
   RowBox[{"rvec", "[", "t", "]"}]}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"rhat", "'"}], "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], " ", 
       RowBox[{"\[Theta]hat", "[", "t", "]"}]}], "+", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], 
       RowBox[{"\[Phi]hat", "[", "t", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]hat", "'"}], "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], " ", 
       RowBox[{"rhat", "[", "t", "]"}]}], " ", "-", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], 
       RowBox[{"rhat", "[", "t", "]"}]}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"xhat", "'"}], "[", "t_", "]"}], " ", ":=", " ", "0"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"yhat", "'"}], "[", "t_", "]"}], " ", ":=", " ", "0"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"zhat", "'"}], "[", "t_", "]"}], " ", ":=", " ", "0"}], ";"}], 
   "*)"}], "\[IndentingNewLine]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$Assumptions", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]", "[", "t", "]"}], "\[Element]", "Reals"}], ",", 
    RowBox[{
     RowBox[{"\[Phi]", "[", "t", "]"}], "\[Element]", "Reals"}]}], "}"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "telling", " ", "mathematica", " ", "that", " ", "the", " ", "vectors", 
    " ", "are", " ", "perpendicular"}], "*)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]", "[", "t", "]"}], "\[Element]", "Reals"}], ",", 
   RowBox[{
    RowBox[{"\[Phi]", "[", "t", "]"}], "\[Element]", "Reals"}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Norm", "[", 
   RowBox[{"rhat", "[", "t", "]"}], "]"}], "]"}]], "Input"],

Cell[BoxData["1"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FullSimplify", "@", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"rvec", "[", "t", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "@", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"hvec", "[", "t", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "1"}], "}"}]}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "r"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Theta]", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], "+", 
    RowBox[{"r", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Phi]", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", "r"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], ",", 
   RowBox[{"r", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["\[Theta]", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["\[Phi]", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], 
  "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "-", 
    RowBox[{"r", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Theta]", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], "+", 
    RowBox[{"r", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Phi]", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", "r"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["z", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "+", 
    RowBox[{"r", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Theta]", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], "+", 
    RowBox[{"r", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Phi]", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}]}]}], "}"}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup forces", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fg2vec", "=", 
   RowBox[{
    RowBox[{"-", "m2"}], " ", "g", " ", "yhat"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fn2vec", "=", 
    RowBox[{
     RowBox[{"fn2", "[", "t", "]"}], " ", 
     RowBox[{"rhat", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Motor", " ", "force"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mtvec", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"motor1", "[", "t", "]"}]}], " ", 
      RowBox[{"\[Theta]hat", "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"motor2", "[", "t", "]"}], 
      RowBox[{"\[Phi]hat", "[", "t", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f1vec", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"f1x", "[", "t", "]"}], " ", 
     RowBox[{"(", "xhat", ")"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"f1z", "[", "t", "]"}], " ", 
     RowBox[{"(", "zhat", ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fg1vec", "=", 
   RowBox[{
    RowBox[{"-", "m1"}], " ", "g", " ", "yhat"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fn1vec", "=", 
   RowBox[{
    RowBox[{"fn1", "[", "t", "]"}], " ", "yhat"}]}], ";"}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Newton\[CloseCurlyQuote]s Laws as vector equations", "Section"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"headeqn", "=", 
   RowBox[{"FullSimplify", "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"fn2vec", "+", "mtvec", " ", "+", " ", "fg2vec"}], "\[Equal]", 
      RowBox[{"m2", " ", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"hvec", "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headeqn", "//", "TraditionalForm"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bodyeqn", "=", 
   RowBox[{"FullSimplify", "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "f1vec", "+", "fn1vec", "+", "fg1vec", "-", "fn2vec", "-", "mtvec"}], 
      "\[Equal]", 
      RowBox[{"m1", " ", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"svec", "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bodyeqn", "//", "TraditionalForm"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bodymomenteqn", "=", 
   RowBox[{"FullSimplify", "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "r"}], " ", "yhat"}], ",", " ", "f1vec"}], "]"}], "+", 
       " ", 
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"r", " ", 
          RowBox[{"rhat", "[", "t", "]"}]}], ",", " ", "mtvec"}], "]"}]}], 
      "\[Equal]", 
      RowBox[{"i", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Omega]1", "'"}], "[", "t", "]"}], " ", "xhat"}], " ", 
         "+", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Omega]2", "'"}], "[", "t", "]"}], " ", "yhat"}], " ", 
         "+", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Omega]3", "'"}], "[", "t", "]"}], "zhat"}]}], ")"}]}]}],
      ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"bodymomenteqn", "//", "TraditionalForm"}]}], "Input"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{
        RowBox[{"cos", "(", 
         RowBox[{"\[Phi]", "(", "t", ")"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"fn2", "(", "t", ")"}], " ", 
           RowBox[{"sin", "(", 
            RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"motor1", "(", "t", ")"}], " ", 
           RowBox[{"cos", "(", 
            RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}]}], ")"}]}]}], "-", 
      RowBox[{
       RowBox[{"motor2", "(", "t", ")"}], " ", 
       RowBox[{"sin", "(", 
        RowBox[{"\[Phi]", "(", "t", ")"}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"fn2", "(", "t", ")"}], " ", 
       RowBox[{"cos", "(", 
        RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}], "-", 
      RowBox[{"g", " ", "m2"}], "-", 
      RowBox[{
       RowBox[{"motor1", "(", "t", ")"}], " ", 
       RowBox[{"sin", "(", 
        RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"sin", "(", 
        RowBox[{"\[Phi]", "(", "t", ")"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"fn2", "(", "t", ")"}], " ", 
          RowBox[{"sin", "(", 
           RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"motor1", "(", "t", ")"}], " ", 
          RowBox[{"cos", "(", 
           RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"motor2", "(", "t", ")"}], " ", 
       RowBox[{"cos", "(", 
        RowBox[{"\[Phi]", "(", "t", ")"}], ")"}]}]}]}], "}"}], "\[LongEqual]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r", " ", 
         RowBox[{"sin", "(", 
          RowBox[{"\[Theta]", "(", "t", ")"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"cos", "(", 
             RowBox[{"\[Phi]", "(", "t", ")"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{
                SuperscriptBox["\[Theta]", "\[Prime]",
                 MultilineFunction->None], "(", "t", ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{
                SuperscriptBox["\[Phi]", "\[Prime]",
                 MultilineFunction->None], "(", "t", ")"}], "2"]}], ")"}]}], 
           "+", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[Phi]", "\[Prime]\[Prime]",
              MultilineFunction->None], "(", "t", ")"}], " ", 
            RowBox[{"sin", "(", 
             RowBox[{"\[Phi]", "(", "t", ")"}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"r", " ", 
         RowBox[{"cos", "(", 
          RowBox[{"\[Theta]", "(", "t", ")"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{
             SuperscriptBox["\[Theta]", "\[Prime]",
              MultilineFunction->None], "(", "t", ")"}], " ", 
            RowBox[{
             SuperscriptBox["\[Phi]", "\[Prime]",
              MultilineFunction->None], "(", "t", ")"}], " ", 
            RowBox[{"sin", "(", 
             RowBox[{"\[Phi]", "(", "t", ")"}], ")"}]}], "-", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
              MultilineFunction->None], "(", "t", ")"}], " ", 
            RowBox[{"cos", "(", 
             RowBox[{"\[Phi]", "(", "t", ")"}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["x", "\[Prime]\[Prime]",
          MultilineFunction->None], "(", "t", ")"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"-", "m2"}], " ", "r", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
           MultilineFunction->None], "(", "t", ")"}], " ", 
         RowBox[{"sin", "(", 
          RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["\[Theta]", "\[Prime]",
            MultilineFunction->None], "(", "t", ")"}], "2"], " ", 
         RowBox[{"cos", "(", 
          RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}]}], ")"}]}], ",", 
     RowBox[{"m2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r", " ", 
         RowBox[{"cos", "(", 
          RowBox[{"\[Phi]", "(", "t", ")"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{
             SuperscriptBox["\[Theta]", "\[Prime]",
              MultilineFunction->None], "(", "t", ")"}], " ", 
            RowBox[{"cos", "(", 
             RowBox[{"\[Theta]", "(", "t", ")"}], ")"}], " ", 
            RowBox[{
             SuperscriptBox["\[Phi]", "\[Prime]",
              MultilineFunction->None], "(", "t", ")"}]}], "+", 
           RowBox[{
            RowBox[{"sin", "(", 
             RowBox[{"\[Theta]", "(", "t", ")"}], ")"}], " ", 
            RowBox[{
             SuperscriptBox["\[Phi]", "\[Prime]\[Prime]",
              MultilineFunction->None], "(", "t", ")"}]}]}], ")"}]}], "+", 
        RowBox[{"r", " ", 
         RowBox[{"sin", "(", 
          RowBox[{"\[Phi]", "(", "t", ")"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
              MultilineFunction->None], "(", "t", ")"}], " ", 
            RowBox[{"cos", "(", 
             RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}], "-", 
           RowBox[{
            RowBox[{"sin", "(", 
             RowBox[{"\[Theta]", "(", "t", ")"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{
                SuperscriptBox["\[Theta]", "\[Prime]",
                 MultilineFunction->None], "(", "t", ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{
                SuperscriptBox["\[Phi]", "\[Prime]",
                 MultilineFunction->None], "(", "t", ")"}], "2"]}], ")"}]}]}],
           ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["z", "\[Prime]\[Prime]",
          MultilineFunction->None], "(", "t", ")"}]}], ")"}]}]}], "}"}]}], 
  TraditionalForm]], "Output"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f1x", "(", "t", ")"}], "+", 
      RowBox[{
       RowBox[{"cos", "(", 
        RowBox[{"\[Phi]", "(", "t", ")"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"fn2", "(", "t", ")"}], " ", 
          RowBox[{"sin", "(", 
           RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"motor1", "(", "t", ")"}], " ", 
          RowBox[{"cos", "(", 
           RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"motor2", "(", "t", ")"}], " ", 
       RowBox[{"sin", "(", 
        RowBox[{"\[Phi]", "(", "t", ")"}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"fn1", "(", "t", ")"}], "-", 
      RowBox[{
       RowBox[{"fn2", "(", "t", ")"}], " ", 
       RowBox[{"cos", "(", 
        RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}], "-", 
      RowBox[{"g", " ", "m1"}], "+", 
      RowBox[{
       RowBox[{"motor1", "(", "t", ")"}], " ", 
       RowBox[{"sin", "(", 
        RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"f1z", "(", "t", ")"}], "-", 
      RowBox[{
       RowBox[{"sin", "(", 
        RowBox[{"\[Phi]", "(", "t", ")"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"fn2", "(", "t", ")"}], " ", 
          RowBox[{"sin", "(", 
           RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"motor1", "(", "t", ")"}], " ", 
          RowBox[{"cos", "(", 
           RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"motor2", "(", "t", ")"}], " ", 
       RowBox[{"cos", "(", 
        RowBox[{"\[Phi]", "(", "t", ")"}], ")"}]}]}]}], "}"}], "\[LongEqual]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m1", " ", 
      RowBox[{
       SuperscriptBox["x", "\[Prime]\[Prime]",
        MultilineFunction->None], "(", "t", ")"}]}], ",", "0", ",", 
     RowBox[{"m1", " ", 
      RowBox[{
       SuperscriptBox["z", "\[Prime]\[Prime]",
        MultilineFunction->None], "(", "t", ")"}]}]}], "}"}]}], 
  TraditionalForm]], "Output"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "r"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f1z", "(", "t", ")"}], "-", 
        RowBox[{
         RowBox[{"motor1", "(", "t", ")"}], " ", 
         RowBox[{"sin", "(", 
          RowBox[{"\[Phi]", "(", "t", ")"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"motor2", "(", "t", ")"}], " ", 
         RowBox[{"cos", "(", 
          RowBox[{"\[Theta]", "(", "t", ")"}], ")"}], " ", 
         RowBox[{"cos", "(", 
          RowBox[{"\[Phi]", "(", "t", ")"}], ")"}]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"-", "r"}], " ", 
      RowBox[{"motor2", "(", "t", ")"}], " ", 
      RowBox[{"sin", "(", 
       RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}], ",", 
     RowBox[{"r", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f1x", "(", "t", ")"}], "+", 
        RowBox[{
         RowBox[{"motor1", "(", "t", ")"}], " ", 
         RowBox[{"cos", "(", 
          RowBox[{"\[Phi]", "(", "t", ")"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"motor2", "(", "t", ")"}], " ", 
         RowBox[{"cos", "(", 
          RowBox[{"\[Theta]", "(", "t", ")"}], ")"}], " ", 
         RowBox[{"sin", "(", 
          RowBox[{"\[Phi]", "(", "t", ")"}], ")"}]}]}], ")"}]}]}], "}"}], 
   "\[LongEqual]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"i", " ", 
      RowBox[{
       SuperscriptBox["\[Omega]1", "\[Prime]",
        MultilineFunction->None], "(", "t", ")"}]}], ",", 
     RowBox[{"i", " ", 
      RowBox[{
       SuperscriptBox["\[Omega]2", "\[Prime]",
        MultilineFunction->None], "(", "t", ")"}]}], ",", 
     RowBox[{"i", " ", 
      RowBox[{
       SuperscriptBox["\[Omega]3", "\[Prime]",
        MultilineFunction->None], "(", "t", ")"}]}]}], "}"}]}], 
  TraditionalForm]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Extract the components of those equations into separate equations\
\>", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "fn2", ",", " ", "fn1", ",", " ", "f1x", ",", " ", "f1z", ",", " ", 
    "\[Theta]", ",", " ", "\[Phi]", ",", " ", "x", ",", " ", "z", ",", " ", 
    "\[Omega]1", ",", " ", "\[Omega]2", ",", " ", 
    RowBox[{"\[Omega]3", " ", "=", " ", 
     RowBox[{"11", " ", "unknowns"}]}], ",", " ", 
    RowBox[{"11", " ", "equations", " ", 
     RowBox[{"(", "\:ff61\:25d5\:203f\:25d5\:ff61", ")"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"eq1", "=", 
    RowBox[{"headeqn", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"eq2", "=", 
    RowBox[{"headeqn", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"eq3", " ", "=", 
    RowBox[{"headeqn", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", " ", "3"}], "]"}], "]"}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"motor1", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"fn2", "[", "t", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}]}], "-", 
   RowBox[{
    RowBox[{"motor2", "[", "t", "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}]}], "\[Equal]", 
  RowBox[{"m2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["x", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "+", 
     RowBox[{"r", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Theta]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Phi]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
     RowBox[{"r", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["\[Theta]", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["\[Phi]", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Phi]", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", "g"}], " ", "m2"}], "+", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
    RowBox[{"fn2", "[", "t", "]"}]}], "-", 
   RowBox[{
    RowBox[{"motor1", "[", "t", "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], "\[Equal]", 
  RowBox[{
   RowBox[{"-", "m2"}], " ", "r", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["\[Theta]", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], " ", 
    RowBox[{"motor2", "[", "t", "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"motor1", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"fn2", "[", "t", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}]}], "\[Equal]", 
  RowBox[{"m2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["z", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "+", 
     RowBox[{"r", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["\[Theta]", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["\[Phi]", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], "+", 
     RowBox[{"r", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Theta]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Phi]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Phi]", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"eq4", " ", "=", " ", 
  RowBox[{"bodyeqn", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"eq5", " ", "=", " ", 
  RowBox[{"bodyeqn", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", " ", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"eq6", " ", "=", " ", 
  RowBox[{"bodyeqn", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", " ", "3"}], "]"}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f1x", "[", "t", "]"}], "+", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"motor1", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"fn2", "[", "t", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"motor2", "[", "t", "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}]}], "\[Equal]", 
  RowBox[{"m1", " ", 
   RowBox[{
    SuperscriptBox["x", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}]}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", "g"}], " ", "m1"}], "+", 
   RowBox[{"fn1", "[", "t", "]"}], "-", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
    RowBox[{"fn2", "[", "t", "]"}]}], "+", 
   RowBox[{
    RowBox[{"motor1", "[", "t", "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], "\[Equal]", 
  "0"}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f1z", "[", "t", "]"}], "+", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
    RowBox[{"motor2", "[", "t", "]"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"motor1", "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"fn2", "[", "t", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}]}], "\[Equal]", 
  RowBox[{"m1", " ", 
   RowBox[{
    SuperscriptBox["z", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"eq7", " ", "=", " ", 
  RowBox[{"bodymomenteqn", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"eq8", " ", "=", " ", 
  RowBox[{"bodymomenteqn", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", " ", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"eq9", " ", "=", " ", 
  RowBox[{"bodymomenteqn", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", " ", "3"}], "]"}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "r"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"f1z", "[", "t", "]"}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
      RowBox[{"motor2", "[", "t", "]"}]}], "-", 
     RowBox[{
      RowBox[{"motor1", "[", "t", "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}]}], ")"}]}], "\[Equal]", 
  RowBox[{"i", " ", 
   RowBox[{
    SuperscriptBox["\[Omega]1", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}]}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "r"}], " ", 
   RowBox[{"motor2", "[", "t", "]"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "\[Equal]", 
  RowBox[{"i", " ", 
   RowBox[{
    SuperscriptBox["\[Omega]2", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}]}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"f1x", "[", "t", "]"}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
      RowBox[{"motor1", "[", "t", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
      RowBox[{"motor2", "[", "t", "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}]}], ")"}]}], "\[Equal]", 
  RowBox[{"i", " ", 
   RowBox[{
    SuperscriptBox["\[Omega]3", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"eq10", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "'"}], "[", "t", "]"}], " ", "\[Equal]", " ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"\[Omega]3", "[", "t", "]"}]}], " ", 
    "r"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"eq11", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "'"}], "[", "t", "]"}], " ", "\[Equal]", " ", 
   RowBox[{
    RowBox[{"\[Omega]1", "[", "t", "]"}], " ", 
    "r"}]}]}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["x", "\[Prime]",
    MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"-", "r"}], " ", 
   RowBox[{"\[Omega]3", "[", "t", "]"}]}]}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["x", "\[Prime]",
    MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
  RowBox[{"r", " ", 
   RowBox[{"\[Omega]1", "[", "t", "]"}]}]}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Eliminate the constraint forces", "Section"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"eqs", "=", 
   RowBox[{"Eliminate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "eq1", ",", "eq2", ",", "eq3", ",", "eq4", ",", "eq5", ",", " ", "eq6", 
       ",", " ", "eq7", ",", " ", "eq8", ",", " ", "eq9", ",", " ", "eq10", 
       ",", " ", "eq11"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"fn1", "[", "t", "]"}], ",", 
       RowBox[{"fn2", "[", "t", "]"}], ",", 
       RowBox[{"f1x", "[", "t", "]"}], ",", " ", 
       RowBox[{"flz", "[", "t", "]"}], ",", " ", 
       RowBox[{"\[Omega]1", "[", "t", "]"}], ",", " ", 
       RowBox[{"\[Omega]2", "[", "t", "]"}], ",", " ", 
       RowBox[{"\[Omega]3", "[", "t", "]"}]}], "}"}]}], "]"}]}], 
  "*)"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqs", "=", 
  RowBox[{"Eliminate", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "eq1", ",", "eq2", ",", "eq3", ",", "eq4", ",", "eq5", ",", " ", "eq6", 
      ",", " ", "eq7", ",", " ", "eq8", ",", " ", "eq9", ",", " ", "eq10", 
      ",", " ", "eq11"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"fn1", "[", "t", "]"}], ",", 
      RowBox[{"fn2", "[", "t", "]"}], ",", 
      RowBox[{"f1x", "[", "t", "]"}], ",", " ", 
      RowBox[{"flz", "[", "t", "]"}]}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         TemplateBox[{"1"},
          "OutputSizeLimit`Skeleton",
          DisplayFunction->(FrameBox[
            RowBox[{"\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
            Background -> GrayLevel[0.75], 
            BaseStyle -> {
             "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
              ShowStringCharacters -> False}, BaselinePosition -> Baseline, 
            ContentPadding -> False, FrameMargins -> 1, FrameStyle -> 
            GrayLevel[0.75], RoundingRadius -> 7]& )],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{65., {3., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarCategory",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{52., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 125, 26820132726438322691, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{62., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 125, 26820132726438322691, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{44., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 125, 26820132726438322691, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{78., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Background->RGBColor[0.9657, 0.9753, 0.9802],
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[125]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "eqs", "]"}]], "Input"],

Cell[BoxData["22"], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numerically approximate the solution", "Section"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"control", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"motor1", "[", "t", "]"}], "==", "0"}], ",", 
     RowBox[{
      RowBox[{"motor2", "[", "t", "]"}], "\[Equal]", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"initialConds", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     RowBox[{"z", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     RowBox[{"\[Phi]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "'"}], "[", "0", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"z", "'"}], "[", "0", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Phi]", "'"}], "[", "0", "]"}], "\[Equal]", "0"}]}], 
   "}"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{"z", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{"\[Phi]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "\[Prime]",
      MultilineFunction->None], "[", "0", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["z", "\[Prime]",
      MultilineFunction->None], "[", "0", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]",
      MultilineFunction->None], "[", "0", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Phi]", "\[Prime]",
      MultilineFunction->None], "[", "0", "]"}], "\[Equal]", "0"}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"NDSolveValue", "[", 
   RowBox[{
    RowBox[{"Flatten", "@", 
     RowBox[{"{", 
      RowBox[{
      "eq1", ",", "eq2", ",", "eq3", ",", "eq4", ",", "eq5", ",", " ", "eq6", 
       ",", " ", "eq7", ",", " ", "eq8", ",", " ", "eq9", ",", " ", "eq10", 
       ",", " ", "eq11", ",", "control", ",", "initialConds"}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "[", "t", "]"}], ",", 
      RowBox[{"z", "[", "t", "]"}], ",", 
      RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
      RowBox[{"\[Phi]", "[", "t", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "10"}], "}"}]}], "]"}], "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"NDSolve", "[", 
  RowBox[{
   RowBox[{"Flatten", "@", 
    RowBox[{"{", 
     RowBox[{"eqs", ",", "control", ",", "initialConds"}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "[", "t", "]"}], ",", 
     RowBox[{"z", "[", "t", "]"}], ",", 
     RowBox[{"\[Theta]", "[", "t", "]"}], ",", 
     RowBox[{"\[Phi]", "[", "t", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "10"}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<IndexReduction\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Pantelides\>\"", ",", " ", 
        RowBox[{
        "\"\<ConstraintMethod\>\"", "\[Rule]", "\"\<Projection\>\""}]}], 
       "}"}]}], "}"}]}]}], "]"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solve for x\[CloseCurlyQuote]\[CloseCurlyQuote] and \[Theta]\
\[CloseCurlyQuote]\[CloseCurlyQuote]", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"textReplace", "=", 
  RowBox[{"<|", 
   RowBox[{
    RowBox[{"m1", "\[Rule]", 
     SubscriptBox["m", "1"]}], ",", 
    RowBox[{"m2", "\[Rule]", 
     SubscriptBox["m", "2"]}], ",", 
    RowBox[{"i", "\[Rule]", "\"\<I\>\""}], ",", 
    RowBox[{"Kpx", "\[Rule]", 
     SubscriptBox["P", "x"]}], ",", 
    RowBox[{"Kdx", "\[Rule]", "\"\<\!\(\*SubscriptBox[\(D\), \(x\)]\)\>\""}], 
    ",", 
    RowBox[{"Kp\[Theta]", "\[Rule]", 
     SubscriptBox["P", "\[Theta]"]}], ",", 
    RowBox[{
    "Kd\[Theta]", "\[Rule]", 
     "\"\<\!\(\*SubscriptBox[\(D\), \(\[Theta]\)]\)\>\""}]}], 
   "|>"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"m1", "\[Rule]", 
    SubscriptBox["m", "1"]}], ",", 
   RowBox[{"m2", "\[Rule]", 
    SubscriptBox["m", "2"]}], ",", 
   RowBox[{"i", "\[Rule]", "\<\"I\"\>"}], ",", 
   RowBox[{"Kpx", "\[Rule]", 
    SubscriptBox["P", "x"]}], ",", 
   RowBox[{
   "Kdx", "\[Rule]", "\<\"\\!\\(\\*SubscriptBox[\\(D\\), \\(x\\)]\\)\"\>"}], 
   ",", 
   RowBox[{"Kp\[Theta]", "\[Rule]", 
    SubscriptBox["P", "\[Theta]"]}], ",", 
   RowBox[{
   "Kd\[Theta]", 
    "\[Rule]", "\<\"\\!\\(\\*SubscriptBox[\\(D\\), \
\\(\[Theta]\\)]\\)\"\>"}]}], "\[RightAssociation]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "''"}], "[", "t", "]"}], "\[Rule]", "xdd"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Theta]", "''"}], "[", "t", "]"}], "\[Rule]", "\[Theta]dd"}],
      ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"z", "''"}], "[", "t", "]"}], "\[Rule]", "zdd"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "''"}], "[", "t", "]"}], "\[Rule]", "\[Phi]dd"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"eqs", "/.", "rules"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "xdd", ",", "\[Theta]dd", ",", " ", "zdd", ",", " ", "\[Phi]dd"}], 
       "}"}]}], "]"}], "/.", 
    RowBox[{"(", 
     RowBox[{"Reverse", "/@", "rules"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Apply", "[", 
      RowBox[{"Equal", ",", "#"}], "]"}], "&"}], "/@", 
    RowBox[{"sol", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}]}], "Input"],

Cell[BoxData["$Aborted"], "Output"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"$RecursionLimit", "::", "reclim2"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Recursion depth of \
\[NoBreak]\\!\\(\\*RowBox[{\\\"1024\\\"}]\\)\[NoBreak] exceeded during \
evaluation of \[NoBreak]\\!\\(\\*RowBox[{\\\"sol\\\", \
\\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\)\
\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/$RecursionLimit\\\", ButtonNote -> \
\\\"$RecursionLimit::reclim2\\\"]\\)\"\>"}]], "Message", "MSG"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Column", "[", 
   RowBox[{"sol", ",", 
    RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], "//", 
  "TraditionalForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<eqn.svg\>\"", ",", "%"}], "]"}], "*)"}]}]}], "Input"],

Cell[BoxData[
 FormBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "\[Prime]\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], "\[LongEqual]", 
       FractionBox[
        RowBox[{
         SuperscriptBox["r", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m2", " ", 
            RowBox[{"sin", "(", 
             RowBox[{"\[Theta]", "(", "t", ")"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"r", " ", 
               SuperscriptBox[
                RowBox[{
                 SuperscriptBox["\[Theta]", "\[Prime]",
                  MultilineFunction->None], "(", "t", ")"}], "2"]}], "-", 
              RowBox[{"g", " ", 
               RowBox[{"cos", "(", 
                RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"motor", "(", "t", ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"cos", "(", 
               RowBox[{"\[Theta]", "(", "t", ")"}], ")"}], "+", "1"}], 
             ")"}]}]}], ")"}]}], 
        RowBox[{"i", "+", 
         RowBox[{"m1", " ", 
          SuperscriptBox["r", "2"]}], "+", 
         RowBox[{"m2", " ", 
          SuperscriptBox["r", "2"], " ", 
          RowBox[{
           SuperscriptBox["sin", "2"], "(", 
           RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}]}]]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], "\[LongEqual]", 
       FractionBox[
        RowBox[{
         RowBox[{"m2", " ", 
          RowBox[{"sin", "(", 
           RowBox[{"\[Theta]", "(", "t", ")"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", 
             RowBox[{"(", 
              RowBox[{"i", "+", 
               RowBox[{
                SuperscriptBox["r", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"m1", "+", "m2"}], ")"}]}]}], ")"}]}], "-", 
            RowBox[{"m2", " ", 
             SuperscriptBox["r", "3"], " ", 
             SuperscriptBox[
              RowBox[{
               SuperscriptBox["\[Theta]", "\[Prime]",
                MultilineFunction->None], "(", "t", ")"}], "2"], " ", 
             RowBox[{"cos", "(", 
              RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"motor", "(", "t", ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"i", "+", 
            RowBox[{
             SuperscriptBox["r", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"m1", "+", "m2"}], ")"}]}], "+", 
            RowBox[{"m2", " ", 
             SuperscriptBox["r", "2"], " ", 
             RowBox[{"cos", "(", 
              RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}]}], ")"}]}]}], 
        RowBox[{"m2", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{"i", "+", 
           RowBox[{"m1", " ", 
            SuperscriptBox["r", "2"]}], "+", 
           RowBox[{"m2", " ", 
            SuperscriptBox["r", "2"], " ", 
            RowBox[{
             SuperscriptBox["sin", "2"], "(", 
             RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}]}], ")"}]}]]}]}
    },
    DefaultBaseStyle->"Column",
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"], TraditionalForm]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Symbol", "[", "\"\<I\>\"", "]"}], "//", 
  "TraditionalForm"}]], "Input"],

Cell[BoxData[
 FormBox["\[ImaginaryI]", TraditionalForm]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", "/.", "textReplace"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{
      SuperscriptBox["r", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], ")"}], " ", 
         RowBox[{"motor", "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
         SubscriptBox["m", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "g"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"r", " ", 
            SuperscriptBox[
             RowBox[{
              SuperscriptBox["\[Theta]", "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}]}]}],
        ")"}]}], 
     RowBox[{"\<\"I\"\>", "+", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       SubscriptBox["m", "1"]}], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], "2"], " ", 
       SubscriptBox["m", "2"]}]}]]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"motor", "[", "t", "]"}]}], " ", 
        RowBox[{"(", 
         RowBox[{"\<\"I\"\>", "+", 
          RowBox[{
           SuperscriptBox["r", "2"], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
           SubscriptBox["m", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["r", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["m", "1"], "+", 
             SubscriptBox["m", "2"]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
        SubscriptBox["m", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{"\<\"I\"\>", "+", 
             RowBox[{
              SuperscriptBox["r", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["m", "1"], "+", 
                SubscriptBox["m", "2"]}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{
           SuperscriptBox["r", "3"], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
           SubscriptBox["m", "2"], " ", 
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["\[Theta]", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}]}]}], 
      ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"r", " ", 
       SubscriptBox["m", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"\<\"I\"\>", "+", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", 
          SubscriptBox["m", "1"]}], "+", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], "2"], " ", 
          SubscriptBox["m", "2"]}]}], ")"}]}], ")"}]}]}]}], "}"}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linearize equations", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"motorPDRule", "=", 
  RowBox[{"<|", 
   RowBox[{
    RowBox[{"motor", "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"Kpx", " ", 
      RowBox[{"x", "[", "t", "]"}]}], "+", 
     RowBox[{"Kp\[Theta]", " ", 
      RowBox[{"\[Theta]", "[", "t", "]"}]}], "+", 
     RowBox[{"Kdx", " ", 
      RowBox[{
       RowBox[{"x", "'"}], "[", "t", "]"}]}], " ", "+", 
     RowBox[{"Kd\[Theta]", " ", 
      RowBox[{
       RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}]}]}], "|>"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"motor", "[", "t", "]"}], "\[Rule]", 
   RowBox[{
    RowBox[{"Kpx", " ", 
     RowBox[{"x", "[", "t", "]"}]}], "+", 
    RowBox[{"Kp\[Theta]", " ", 
     RowBox[{"\[Theta]", "[", "t", "]"}]}], "+", 
    RowBox[{"Kdx", " ", 
     RowBox[{
      SuperscriptBox["x", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], "+", 
    RowBox[{"Kd\[Theta]", " ", 
     RowBox[{
      SuperscriptBox["\[Theta]", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}]}]}], 
  "\[RightAssociation]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"zeroMotorRule", "=", 
  RowBox[{"<|", 
   RowBox[{
    RowBox[{"Kpx", "\[Rule]", "0"}], " ", ",", 
    RowBox[{"Kp\[Theta]", " ", "\[Rule]", "0"}], ",", 
    RowBox[{"Kdx", " ", "\[Rule]", "0"}], ",", " ", 
    RowBox[{"Kd\[Theta]", "\[Rule]", "0"}]}], "|>"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"Kpx", "\[Rule]", "0"}], ",", 
   RowBox[{"Kp\[Theta]", "\[Rule]", "0"}], ",", 
   RowBox[{"Kdx", "\[Rule]", "0"}], ",", 
   RowBox[{"Kd\[Theta]", "\[Rule]", "0"}]}], 
  "\[RightAssociation]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"linearizedEquations", "=", 
  RowBox[{"MapAt", "[", 
   RowBox[{"Simplify", ",", 
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{"sol", "/.", "motorPDRule"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Theta]", "[", "t", "]"}], ",", "0", ",", "1"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], ",", "0", ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "[", "t", "]"}], ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "'"}], "[", "t", "]"}], ",", "0", ",", "1"}], "}"}]}], 
      "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", "Kpx", " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"x", "[", "t", "]"}]}], 
      RowBox[{"i", "+", 
       RowBox[{"m1", " ", 
        SuperscriptBox["r", "2"]}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "Kp\[Theta]"}], "-", 
         RowBox[{"g", " ", "m2"}]}], ")"}], " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], 
      RowBox[{"i", "+", 
       RowBox[{"m1", " ", 
        SuperscriptBox["r", "2"]}]}]], "+", 
     FractionBox[
      RowBox[{"2", " ", "Kdx", " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{
        SuperscriptBox["x", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{"i", "+", 
       RowBox[{"m1", " ", 
        SuperscriptBox["r", "2"]}]}]], "+", 
     FractionBox[
      RowBox[{"2", " ", "Kd\[Theta]", " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{
        SuperscriptBox["\[Theta]", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{"i", "+", 
       RowBox[{"m1", " ", 
        SuperscriptBox["r", "2"]}]}]]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"m2", " ", "r", " ", 
       RowBox[{"(", 
        RowBox[{"i", "+", 
         RowBox[{"m1", " ", 
          SuperscriptBox["r", "2"]}]}], ")"}]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "Kpx"}], " ", 
        RowBox[{"(", 
         RowBox[{"i", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m1", "+", 
             RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
           SuperscriptBox["r", "2"]}]}], ")"}], " ", 
        RowBox[{"x", "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"i", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "Kp\[Theta]"}], "+", 
             RowBox[{"g", " ", "m2"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", "m2", " ", 
              RowBox[{"(", 
               RowBox[{"m1", "+", "m2"}], ")"}]}], "-", 
             RowBox[{"Kp\[Theta]", " ", 
              RowBox[{"(", 
               RowBox[{"m1", "+", 
                RowBox[{"2", " ", "m2"}]}], ")"}]}]}], ")"}], " ", 
           SuperscriptBox["r", "2"]}]}], ")"}], " ", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m1", "+", 
             RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
           SuperscriptBox["r", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Kdx", " ", 
           RowBox[{
            SuperscriptBox["x", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], "+", 
          RowBox[{"Kd\[Theta]", " ", 
           RowBox[{
            SuperscriptBox["\[Theta]", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], 
      ")"}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"linearizedEquations", "/.", "textReplace"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["r", "2"], " ", 
       SubscriptBox["P", "x"], " ", 
       RowBox[{"x", "[", "t", "]"}]}], 
      RowBox[{"\<\"I\"\>", "+", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        SubscriptBox["m", "1"]}]}]], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "g"}], " ", 
          SubscriptBox["m", "2"]}], "+", 
         RowBox[{"2", " ", 
          SubscriptBox["P", "\[Theta]"]}]}], ")"}], " ", 
       RowBox[{"\[Theta]", "[", "t", "]"}]}], 
      RowBox[{"\<\"I\"\>", "+", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        SubscriptBox["m", "1"]}]}]], "+", 
     FractionBox[
      RowBox[{
      "2", " ", "\<\"\\!\\(\\*SubscriptBox[\\(D\\), \\(x\\)]\\)\"\>", " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{
        SuperscriptBox["x", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{"\<\"I\"\>", "+", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        SubscriptBox["m", "1"]}]}]], "+", 
     FractionBox[
      RowBox[{
      "2", " ", "\<\"\\!\\(\\*SubscriptBox[\\(D\\), \\(\[Theta]\\)]\\)\"\>", 
       " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{
        SuperscriptBox["\[Theta]", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{"\<\"I\"\>", "+", 
       RowBox[{
        SuperscriptBox["r", "2"], " ", 
        SubscriptBox["m", "1"]}]}]]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "\[Equal]", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"\<\"I\"\>", "+", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", 
          SubscriptBox["m", "1"]}]}], ")"}], " ", 
       SubscriptBox["m", "2"]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"\<\"I\"\>", "+", 
           RowBox[{
            SuperscriptBox["r", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["m", "1"], "+", 
              RowBox[{"2", " ", 
               SubscriptBox["m", "2"]}]}], ")"}]}]}], ")"}]}], " ", 
        SubscriptBox["P", "x"], " ", 
        RowBox[{"x", "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\<\"I\"\>", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", 
              SubscriptBox["m", "2"]}], "-", 
             SubscriptBox["P", "\[Theta]"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["r", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", 
              SubscriptBox["m", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["m", "1"], "+", 
                SubscriptBox["m", "2"]}], ")"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["m", "1"], "+", 
                RowBox[{"2", " ", 
                 SubscriptBox["m", "2"]}]}], ")"}], " ", 
              SubscriptBox["P", "\[Theta]"]}]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\<\"I\"\>", "+", 
          RowBox[{
           SuperscriptBox["r", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["m", "1"], "+", 
             RowBox[{"2", " ", 
              SubscriptBox["m", "2"]}]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(D\\), \\(x\\)]\\)\"\>", " ", 
           RowBox[{
            SuperscriptBox["x", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], "+", 
          
          RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(D\\), \\(\[Theta]\\)]\\)\"\>",
            " ", 
           RowBox[{
            SuperscriptBox["\[Theta]", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], 
      ")"}]}]}]}], "}"}]], "Output"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`i$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`i$$], 1, 32, 1}}, Typeset`size$$ = {1227., {5., 12.}},
     Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`i$46107$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`i$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`i$$, $CellContext`i$46107$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Part[$CellContext`simpeqs, $CellContext`i$$], 
      "Specifications" :> {{$CellContext`i$$, 1, 32, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{1278., {52., 59.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 998},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
TrackCellChangeTimes->False,
FrontEndVersion->"10.3 for Microsoft Windows (64-bit) (December 10, 2015)",
StyleDefinitions->"Default.nb"
]

